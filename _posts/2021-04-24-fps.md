---
layout: post
title:  "形式的冪級数（FPS）を頑張って理解しようとするメモ"
date:   2021-04-24 17:30:00 +0900
categories: competitive_programming
---
## 概要

何回勉強しても忘れてしまう「形式的冪級数」についてのメモ．


## FPS が使えると何が嬉しいのか

いわゆる「数え上げ」ができるようになる．DP で解けるやつも FPS で解けたりする．


## FPS 学習ステップ

高校卒業程度の数学能力を有している前提で，以下 2 ステップが必要．

1. 「数え上げ → 多項式・形式的冪級数への言い換え」ができるようになる
2. 「多項式・形式的冪級数 → 実際の係数の値を求める」ができるようになる


## ステップ1. 「数え上げ → 多項式・形式的冪級数への言い換え」

まずは次の記事を読む．とてもわかりやすい．

- [\[多項式・形式的べき級数\]（１）数え上げとの対応付け \| maspyのHP](https://maspypy.com/%e5%a4%9a%e9%a0%85%e5%bc%8f%e3%83%bb%e5%bd%a2%e5%bc%8f%e7%9a%84%e3%81%b9%e3%81%8d%e7%b4%9a%e6%95%b0%e6%95%b0%e3%81%88%e4%b8%8a%e3%81%92%e3%81%a8%e3%81%ae%e5%af%be%e5%bf%9c%e4%bb%98%e3%81%91)

また，分割数や累積和からの言い換えは，以下でも解説されている．読んでみると理解を深められるはず．

- [\[数学\] 形式的べき級数による数え上げ（AtCoder JSC2019予選問題F） \| maspyのHP](https://maspypy.com/%E6%95%B0%E5%AD%A6-%E5%BD%A2%E5%BC%8F%E7%9A%84%E3%81%B9%E3%81%8D%E7%B4%9A%E6%95%B0%E3%81%AB%E3%82%88%E3%82%8B%E6%95%B0%E3%81%88%E4%B8%8A%E3%81%92%EF%BC%88jsc2019%E4%BA%88%E9%81%B8%E5%95%8F%E9%A1%8Cf)


### 結局，どうやって言い換えるのか

$f=\sum_{(状態)}\ (場合の数)x^{(状態を表す式)}$ の形で式を書く．この形の多項式同士を掛け合わせると，指数部（状態を表す式）を見ると加算，係数（場合の数）を見ると乗算が行われることになる．状態 $n$ に対応する場合の数が欲しいときは， $f$ の $x^n$ の係数を求めればよい．$f$ の $x^n$ の係数を，$\[x^n\]f$ と書く．


### 式変形が必要な場合

形式的冪級数で表せたとしても，そのままでは計算量的に扱えないこともある．そのようなときは，式変形を行って，頑張って扱える形にする．

- [\[多項式・形式的べき級数\]（２）式変形による解法の導出 \| maspyのHP](https://maspypy.com/%e5%a4%9a%e9%a0%85%e5%bc%8f%e3%83%bb%e5%bd%a2%e5%bc%8f%e7%9a%84%e3%81%b9%e3%81%8d%e7%b4%9a%e6%95%b0%ef%bc%88%ef%bc%92%ef%bc%89%e5%bc%8f%e5%a4%89%e5%bd%a2%e3%81%ab%e3%82%88%e3%82%8b%e8%a7%a3%e6%b3%95)

また，式変形を行うことで見通しがよくなる．

式変形では，普通の文字式と同じく，等比数列の和の公式が使えるほか，類似するいくつかの典型的変形パターンが使える．


## ステップ2. 多項式・形式的冪級数 → 実際の係数の値を求める

FPS ライブラリを借りるのが手っ取り早い．

- [形式的冪級数（FPS）ライブラリの実装例（C\+\+） \| opt の競プロブログ](https://opt-cp.com/fps-implementation/)
- [形式的冪級数（FPS）が使える AtCoder の問題リスト（随時更新） \| opt の競プロブログ](https://opt-cp.com/fps-problem-list/)

-----

以上
